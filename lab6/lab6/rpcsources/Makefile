
# This is a template Makefile generated by rpcgen

# Parameters

CLIENT = libim_client.a
SERVER = im_server

PGSQ_DIR=/usr/include/postgresql/
PGSQ_LIB=/opt/PostgreSQL/9.3/lib/

SOURCES_CLNT.c = 
SOURCES_CLNT.h = 
SOURCES_SVC.c = 
SOURCES_SVC.h = 
SOURCES_SERVER.c = im_server.c im_svc.c
SOURCES.x = im.x

TARGETS_SVC.c = im_xdr.c 
TARGETS_CLNT.c = im_clnt.c im_client.c im_xdr.c 
TARGETS = im.h im_xdr.c im_clnt.c im_svc.c im_client.c im_server.c

OBJECTS_CLNT = $(SOURCES_CLNT.c:%.c=%.o) $(TARGETS_CLNT.c:%.c=%.o)
OBJECTS_SVC = $(SOURCES_SVC.c:%.c=%.o) $(TARGETS_SVC.c:%.c=%.o)
OBJECTS_SERVER = $(SOURCES_SERVER.c:%.c=%.o)
# Compiler flags 

CFLAGS += -g
LDLIBS += -lnsl

# Targets 

all : $(CLIENT) $(SERVER)

$(OBJECTS_CLNT) : $(SOURCES_CLNT.c) $(SOURCES_CLNT.h) $(TARGETS_CLNT.c) 

$(OBJECTS_SVC) : $(SOURCES_SVC.c) $(SOURCES_SVC.h) $(TARGETS_SVC.c) 

$(OBJECTS_SERVER) : $(SOURCES_SERVER.c)
	$(CC) -c -I $(PGSQ_DIR) $^

$(CLIENT) : $(OBJECTS_CLNT) 
	$(AR) rcs $(CLIENT) $(OBJECTS_CLNT) #$(CC) -o $(CLIENT) $(OBJECTS_CLNT) $(LDLIBS) 

$(SERVER) : $(OBJECTS_SVC) $(OBJECTS_SERVER)
	$(CC) -o $(SERVER) $(OBJECTS_SERVER) $(OBJECTS_SVC) $(LDLIBS) -L ${PGSQ_LIB} -lpq

clean:
	 $(RM) core $(OBJECTS_CLNT) $(OBJECTS_SVC) $(CLIENT) $(SERVER)

